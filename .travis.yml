language: generic
env:
  - BUILD='--alpine'
  - BUILD='-f --ubuntu cowsay'

install:

  # install plash and dependencies
  - sudo apt-get install python3 python3-pip unionfs-fuse uidmap
  - sudo pip3 install plash

cache:
  directories:
    - ~/plashcache

script:

  # load the plash cache
  - mkdir ~/plashcache
  - plash sudo tar -xvf ~/plashcache/data.tar -C /
  - plash init

  - plash run --include-string " $BUILD" -- printf 'heellow'

  # save the plash cache
  - plash sudo tar -cvf ~/plashcache/data.tar ~/.plashdata
  - ls ~/plashcache/data.tar
  - file ~/plashcache/data.tar
